import asyncio


async def slow_operation(delay):
    """
    Имитирует операцию, которая длится 'delay' секунд
    и возвращает результат.
    """
    print(f"  >> Начало медленной операции ({delay} сек)...")
    await asyncio.sleep(delay)
    print(f"  >> Медленная операция ({delay} сек) завершена.")
    return f"Результат операции за {delay} сек."


async def main():
    # --- СЦЕНАРИЙ 1: УСПЕХ ---
    # Операция длится 1 секунду, а тайм-аут - 2 секунды.
    print("--- Сценарий 1: Успех (операция 1 сек, тайм-аут 2 сек) ---")
    try:
        # Ждем результат, и он должен прийти вовремя.
        result = await asyncio.wait_for(slow_operation(1), timeout=2.0)
        print(f"  УСПЕХ! Получен результат: '{result}'")
    except asyncio.TimeoutError:
        # Этот блок не должен выполниться.
        print("  ПРОВАЛ! Тайм-аут сработал, хотя не должен был.")

    print("\n" + "=" * 60 + "\n")

    # --- СЦЕНАРИЙ 2: ПРОВАЛ ---
    # Операция длится 3 секунды, а тайм-аут - всего 2 секунды.
    print("--- Сценарий 2: Провал (операция 3 сек, тайм-аут 2 сек) ---")
    try:
        # Пытаемся дождаться результата, но время выйдет раньше.
        result = await asyncio.wait_for(slow_operation(3), timeout=2.0)
        # Эта строка никогда не выполнится.
        print(f"  УСПЕХ! Получен результат: '{result}'")
    except asyncio.TimeoutError:
        # Выполнение перейдет сюда ровно через 2 секунды.
        print("  ПРОВАЛ! Сработало исключение asyncio.TimeoutError, как и ожидалось.")

    # Дадим программе еще немного времени, чтобы увидеть,
    # что отмененная задача действительно не выводит сообщение о завершении.
    await asyncio.sleep(2)
    print("\nПрограмма завершена.")


# Запускаем
asyncio.run(main())